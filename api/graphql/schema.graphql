"A date string with format `Y-m-d`, e.g. `2011-05-23`."
scalar Date @scalar(class: "Nuwave\\Lighthouse\\Schema\\Types\\Scalars\\Date")

"A datetime string with format `Y-m-d H:i:s`, e.g. `2018-05-23 13:43:32`."
scalar DateTime
  @scalar(class: "Nuwave\\Lighthouse\\Schema\\Types\\Scalars\\DateTime")

"A RFC 5321 compliant email."
scalar Email @scalar(class: "MLL\\GraphQLScalars\\Email")

"A phone number string, accepts any string"
scalar PhoneNumber

"A human readable ID"
scalar KeyString

"Arbitrary data encoded in JavaScript Object Notation. See https://www.json.org."
scalar JSON @scalar(class: "MLL\\GraphQLScalars\\JSON")

"128 bit universally unique identifier (UUID)"
scalar UUID @scalar(class: "UUID")

type LocalizedString {
  en: String
  fr: String
}

enum Language {
  EN @enum(value: "en")
  FR @enum(value: "fr")
}

enum Role {
  "A user who has administrator privileges"
  ADMIN
  "A user who has a profile to apply to hiring pools"
  APPLICANT
}

type User {
  id: ID!
  sub: String
  roles: [Role]
  createdDate: DateTime @rename(attribute: "created_at")
  updatedDate: DateTime @rename(attribute: "updated_at")

  # Personal info
  firstName: String @rename(attribute: "first_name")
  lastName: String @rename(attribute: "last_name")
  email: Email
  telephone: PhoneNumber
  preferredLang: Language @rename(attribute: "preferred_lang")
  preferredLanguageForInterview: Language @rename(attribute: "preferred_language_for_interview")
  preferredLanguageForExam: Language @rename(attribute: "preferred_language_for_exam")
  currentProvince: ProvinceOrTerritory @rename(attribute: "current_province")
  currentCity: String @rename(attribute: "current_city")
  citizenship: CitizenshipStatus
  armedForcesStatus: ArmedForcesStatus @rename(attribute: "armed_forces_status")

  # Language
  languageAbility: LanguageAbility
    @rename(attribute: "language_ability")
    @deprecated(reason: "deprecated in favour of relying on lookingFor<Language>")
  lookingForEnglish: Boolean @rename(attribute: "looking_for_english")
  lookingForFrench: Boolean @rename(attribute: "looking_for_french")
  lookingForBilingual: Boolean @rename(attribute: "looking_for_bilingual")
  bilingualEvaluation: BilingualEvaluation
    @rename(attribute: "bilingual_evaluation")
  comprehensionLevel: EvaluatedLanguageAbility
    @rename(attribute: "comprehension_level")
  writtenLevel: EvaluatedLanguageAbility @rename(attribute: "written_level")
  verbalLevel: EvaluatedLanguageAbility @rename(attribute: "verbal_level")
  estimatedLanguageAbility: EstimatedLanguageAbility
    @rename(attribute: "estimated_language_ability")

  # Gov info
  isGovEmployee: Boolean @rename(attribute: "is_gov_employee")
  govEmployeeType: GovEmployeeType @rename(attribute: "gov_employee_type")
  currentClassification: Classification @belongsTo # Users current classification
  department: Department @belongsTo
  hasPriorityEntitlement: Boolean @rename(attribute: "has_priority_entitlement")
  priorityNumber: String @rename(attribute: "priority_number")

  # Employment equity
  isWoman: Boolean @rename(attribute: "is_woman")
  hasDisability: Boolean @rename(attribute: "has_disability")
  isIndigenous: Boolean
    @rename(attribute: "is_indigenous")
    @deprecated(reason: "replaced by indigenousCommunities")
  isVisibleMinority: Boolean @rename(attribute: "is_visible_minority")
  indigenousCommunities: [IndigenousCommunity]
    @rename(attribute: "indigenous_communities")
  indigenousDeclarationSignature: String
    @rename(attribute: "indigenous_declaration_signature")

  # Applicant info
  jobLookingStatus: JobLookingStatus @rename(attribute: "job_looking_status")
  hasDiploma: Boolean @rename(attribute: "has_diploma")
  locationPreferences: [WorkRegion] @rename(attribute: "location_preferences")
  locationExemptions: String @rename(attribute: "location_exemptions")
  acceptedOperationalRequirements: [OperationalRequirement]
    @rename(attribute: "accepted_operational_requirements")
  expectedSalary: [SalaryRange] @rename(attribute: "expected_salary")
  expectedClassifications: [Classification] @belongsToMany
  wouldAcceptTemporary: Boolean
    @rename(attribute: "would_accept_temporary")
    @deprecated(reason: "replaced with positionDuration")
  positionDuration: [PositionDuration] @rename(attribute: "position_duration")

  # Pool info
  poolCandidates: [PoolCandidate] @hasMany # PoolsCandidate objects associate the user with a pool
  # Experiences
  experiences: [Experience] # All experiences that a user owns
  awardExperiences: [AwardExperience] @hasMany # Award experiences that a user owns
  communityExperiences: [CommunityExperience] @hasMany # Community experiences that a user owns
  educationExperiences: [EducationExperience] @hasMany # Education experiences that a user owns
  personalExperiences: [PersonalExperience] @hasMany # Personal experiences that a user owns
  workExperiences: [WorkExperience] @hasMany # Work experiences that a user owns
  # Pool Manager info
  pools: [Pool] @hasMany # Pools a user owns
  # Profile Status
  isProfileComplete: Boolean
  expectedGenericJobTitles: [GenericJobTitle] @belongsToMany
  priorityWeight: Int @rename(attribute: "priority_weight")
}

enum ProvinceOrTerritory {
  BRITISH_COLUMBIA
  ALBERTA
  SASKATCHEWAN
  MANITOBA
  ONTARIO
  QUEBEC
  NEW_BRUNSWICK
  NOVA_SCOTIA
  PRINCE_EDWARD_ISLAND
  NEWFOUNDLAND_AND_LABRADOR
  YUKON
  NORTHWEST_TERRITORIES
  NUNAVUT
}

enum BilingualEvaluation {
  COMPLETED_ENGLISH
  COMPLETED_FRENCH
  NOT_COMPLETED
}

enum EvaluatedLanguageAbility {
  X
  A
  B
  C
  E
  P
}

enum EstimatedLanguageAbility {
  BEGINNER
  INTERMEDIATE
  ADVANCED
}

enum JobLookingStatus {
  ACTIVELY_LOOKING
  OPEN_TO_OPPORTUNITIES
  INACTIVE
}

enum GovEmployeeType {
  STUDENT
  CASUAL
  TERM
  INDETERMINATE
}

enum CitizenshipStatus {
  CITIZEN
  PERMANENT_RESIDENT
  OTHER
}

enum ArmedForcesStatus {
  VETERAN
  MEMBER
  NON_CAF
}

enum PositionDuration {
  TEMPORARY
  PERMANENT
}

enum IndigenousCommunity {
  STATUS_FIRST_NATIONS
  NON_STATUS_FIRST_NATIONS
  INUIT
  METIS
  OTHER
  LEGACY_IS_INDIGENOUS
}

type Applicant {
  id: ID!

  # Personal info
  firstName: String @rename(attribute: "first_name")
  lastName: String @rename(attribute: "last_name")
  email: Email
  telephone: PhoneNumber
  preferredLang: Language @rename(attribute: "preferred_lang")
  preferredLanguageForInterview: Language @rename(attribute: "preferred_language_for_interview")
  preferredLanguageForExam: Language @rename(attribute: "preferred_language_for_exam")
  currentProvince: ProvinceOrTerritory @rename(attribute: "current_province")
  currentCity: String @rename(attribute: "current_city")
  citizenship: CitizenshipStatus
  armedForcesStatus: ArmedForcesStatus @rename(attribute: "armed_forces_status")

  # Gov info
  isGovEmployee: Boolean @rename(attribute: "is_gov_employee")
  govEmployeeType: GovEmployeeType @rename(attribute: "gov_employee_type")
  currentClassification: Classification @belongsTo # Users current classification
  department: Department @belongsTo
  hasPriorityEntitlement: Boolean @rename(attribute: "has_priority_entitlement")
  priorityNumber: String @rename(attribute: "priority_number")

  # Language
  languageAbility: LanguageAbility
    @rename(attribute: "language_ability")
    @deprecated(reason: "deprecated in favour of relying on lookingFor<Language>")
  lookingForEnglish: Boolean @rename(attribute: "looking_for_english")
  lookingForFrench: Boolean @rename(attribute: "looking_for_french")
  lookingForBilingual: Boolean @rename(attribute: "looking_for_bilingual")
  bilingualEvaluation: BilingualEvaluation
    @rename(attribute: "bilingual_evaluation")
  comprehensionLevel: EvaluatedLanguageAbility
    @rename(attribute: "comprehension_level")
  writtenLevel: EvaluatedLanguageAbility @rename(attribute: "written_level")
  verbalLevel: EvaluatedLanguageAbility @rename(attribute: "verbal_level")
  estimatedLanguageAbility: EstimatedLanguageAbility
    @rename(attribute: "estimated_language_ability")

  # Employment equity
  isWoman: Boolean @rename(attribute: "is_woman")
  hasDisability: Boolean @rename(attribute: "has_disability")
  isIndigenous: Boolean
    @rename(attribute: "is_indigenous")
    @deprecated(reason: "replaced by indigenousCommunities")
  isVisibleMinority: Boolean @rename(attribute: "is_visible_minority")
  indigenousCommunities: [IndigenousCommunity]
    @rename(attribute: "indigenous_communities")
  indigenousDeclarationSignature: String
    @rename(attribute: "indigenous_declaration_signature")

  # Applicant info
  jobLookingStatus: JobLookingStatus @rename(attribute: "job_looking_status")
  poolCandidates: [PoolCandidate] @hasMany @can(ability: "viewAny")

  hasDiploma: Boolean @rename(attribute: "has_diploma")
  locationPreferences: [WorkRegion] @rename(attribute: "location_preferences")
  locationExemptions: String @rename(attribute: "location_exemptions")
  acceptedOperationalRequirements: [OperationalRequirement]
    @rename(attribute: "accepted_operational_requirements")
  expectedSalary: [SalaryRange] @rename(attribute: "expected_salary")
  expectedClassifications: [Classification] @belongsToMany
  wouldAcceptTemporary: Boolean
    @rename(attribute: "would_accept_temporary")
    @deprecated(reason: "replaced with positionDuration")
  positionDuration: [PositionDuration] @rename(attribute: "position_duration")

  # Experiences
  experiences: [Experience]
  awardExperiences: [AwardExperience]
  communityExperiences: [CommunityExperience]
  educationExperiences: [EducationExperience]
  personalExperiences: [PersonalExperience]
  workExperiences: [WorkExperience]

  isProfileComplete: Boolean
  expectedGenericJobTitles: [GenericJobTitle] @belongsToMany
  priorityWeight: Int @rename(attribute: "priority_weight")
}

type UserPublicProfile {
  id: ID!
  email: Email
  firstName: String @rename(attribute: "first_name")
  lastName: String @rename(attribute: "last_name")
}

type Pool {
  id: ID!
  owner: UserPublicProfile @belongsTo(relation: "user")
  name: LocalizedString
  key: KeyString
  description: LocalizedString
  classifications: [Classification] @belongsToMany
  operationalRequirements: [OperationalRequirement]
    @rename(attribute: "operational_requirements")
  poolCandidates: [PoolCandidate] @hasMany @can(ability: "viewAny")
  keyTasks: LocalizedString @rename(attribute: "key_tasks")
  status: PoolStatus
    @rename(attribute: "pool_status")
    @deprecated(reason: "Replaced by advertisementStatus")
  advertisementStatus: AdvertisementStatus
    @rename(attribute: "advertisement_status")
  stream: PoolStream
  processNumber: String @rename(attribute: "process_number")
  publishingGroup: PublishingGroup @rename(attribute: "publishing_group")
  createdDate: DateTime @rename(attribute: "created_at")
}

enum PoolStatus {
  TAKING_APPLICATIONS
  NOT_TAKING_APPLICATIONS
}

enum PoolStream {
  BUSINESS_ADVISORY_SERVICES
  DATABASE_MANAGEMENT
  ENTERPRISE_ARCHITECTURE
  INFRASTRUCTURE_OPERATIONS
  PLANNING_AND_REPORTING
  PROJECT_PORTFOLIO_MANAGEMENT
  SECURITY
  SOFTWARE_SOLUTIONS
  INFORMATION_DATA_FUNCTIONS
}

type PoolAdvertisement {
  id: ID!
  key: KeyString
  owner: UserPublicProfile @belongsTo(relation: "user")
  closingDate: DateTime @rename(attribute: "closing_date")
  publishedAt: DateTime @rename(attribute: "published_at")
  name: LocalizedString
  description: LocalizedString
  classifications: [Classification] @belongsToMany
  keyTasks: LocalizedString @rename(attribute: "key_tasks")
  yourImpact: LocalizedString @rename(attribute: "your_impact")
  isRemote: Boolean @rename(attribute: "is_remote")
  advertisementLocation: LocalizedString
    @rename(attribute: "advertisement_location")
  securityClearance: SecurityStatus @rename(attribute: "security_clearance")
  advertisementLanguage: PoolAdvertisementLanguage
    @rename(attribute: "advertisement_language")
  advertisementStatus: AdvertisementStatus
    @rename(attribute: "advertisement_status")
  essentialSkills: [Skill!] @belongsToMany
  nonessentialSkills: [Skill!] @belongsToMany
  stream: PoolStream
  processNumber: String @rename(attribute: "process_number")
  publishingGroup: PublishingGroup @rename(attribute: "publishing_group")
}

enum AdvertisementStatus {
  DRAFT
  PUBLISHED
  CLOSED
  ARCHIVED
}

enum PoolCandidateStatus {
  DRAFT
  DRAFT_EXPIRED
  NEW_APPLICATION
  APPLICATION_REVIEW
  SCREENED_IN
  SCREENED_OUT_APPLICATION
  UNDER_ASSESSMENT
  SCREENED_OUT_ASSESSMENT
  QUALIFIED_AVAILABLE
  QUALIFIED_UNAVAILABLE
  QUALIFIED_WITHDREW
  PLACED_CASUAL
  PLACED_TERM
  PLACED_INDETERMINATE
  EXPIRED
  REMOVED
}

enum SecurityStatus {
  RELIABILITY
  SECRET
  TOP_SECRET
}

enum PoolAdvertisementLanguage {
  ENGLISH
  FRENCH
  VARIOUS
  BILINGUAL_INTERMEDIATE
  BILINGUAL_ADVANCED
}

enum PublishingGroup {
  IT_JOBS
  IT_JOBS_ONGOING
  EXECUTIVE_JOBS
  OTHER
}

type PoolCandidate {
  id: ID!
  pool: Pool! @belongsTo
  poolAdvertisement: PoolAdvertisement @belongsTo(relation: "pool")
  user: Applicant! @belongsTo(relation: "user")

  # cmoIdentifier can be an arbitrary string used to relate this candidate to an external database.
  cmoIdentifier: ID @rename(attribute: "cmo_identifier")
  # Expiry date for this candidate being in the pool.
  expiryDate: Date @rename(attribute: "expiry_date")

  status: PoolCandidateStatus @rename(attribute: "pool_candidate_status")
  statusWeight: Int @rename(attribute: "status_weight")
  notes: String
  archivedAt: DateTime @rename(attribute: "archived_at")
  submittedAt: DateTime @rename(attribute: "submitted_at")

  profileSnapshot: JSON @rename(attribute: "profile_snapshot")
  signature: String
}

enum LanguageAbility {
  ENGLISH
  FRENCH
  BILINGUAL
}

enum WorkRegion {
  TELEWORK
  NATIONAL_CAPITAL
  ATLANTIC
  QUEBEC
  ONTARIO
  PRAIRIE
  BRITISH_COLUMBIA
  NORTH
}

"""
e.g. Overtime as Required, Shift Work, Travel as Required, etc.
"""
enum OperationalRequirement {
  SHIFT_WORK
  ON_CALL
  TRAVEL
  TRANSPORT_EQUIPMENT
  DRIVERS_LICENSE
  WORK_WEEKENDS
  OVERTIME_SCHEDULED
  OVERTIME_SHORT_NOTICE
  OVERTIME_OCCASIONAL
  OVERTIME_REGULAR
}

enum SalaryRange {
  _50_59K
  _60_69K
  _70_79K
  _80_89K
  _90_99K
  _100K_PLUS
}

type Classification {
  id: ID!
  name: LocalizedString
  group: String!
  level: Int!
  minSalary: Int @rename(attribute: "min_salary")
  maxSalary: Int @rename(attribute: "max_salary")
  genericJobTitles: [GenericJobTitle] @belongsToMany
}

enum GenericJobTitleKey {
  TECHNICIAN_IT01
  ANALYST_IT02
  TEAM_LEADER_IT03
  TECHNICAL_ADVISOR_IT03
  SENIOR_ADVISOR_IT04
  MANAGER_IT04
}

type GenericJobTitle {
  id: ID!
  key: GenericJobTitleKey!
  name: LocalizedString
  classification: Classification @belongsTo
}

type Department {
  id: ID!
  departmentNumber: Int! @rename(attribute: "department_number")
  name: LocalizedString!
}

enum PoolCandidateSearchStatus {
  PENDING
  DONE
}

# equity selections goes with the pool/applicant filters and not user model
type EquitySelections {
  isWoman: Boolean @rename(attribute: "is_woman")
  hasDisability: Boolean @rename(attribute: "has_disability")
  isIndigenous: Boolean @rename(attribute: "is_indigenous")
  isVisibleMinority: Boolean @rename(attribute: "is_visible_minority")
}

input EquitySelectionsInput {
  isWoman: Boolean @rename(attribute: "is_woman")
  hasDisability: Boolean @rename(attribute: "has_disability")
  isVisibleMinority: Boolean @rename(attribute: "is_visible_minority")
  isIndigenous: Boolean @rename(attribute: "is_indigenous")
}

type PoolCandidateFilter {
  id: ID!
  classifications: [Classification] @belongsToMany
  hasDiploma: Boolean @rename(attribute: "has_diploma")
  equity: EquitySelections
  languageAbility: LanguageAbility @rename(attribute: "language_ability")
  operationalRequirements: [OperationalRequirement]
    @rename(attribute: "operational_requirements")
  workRegions: [WorkRegion] @rename(attribute: "work_regions")
  pools: [Pool] @belongsToMany
}

# ApplicantFilter only includes the fields which Talent Seekers can use to search for candidates.
type ApplicantFilter {
  id: ID!
  hasDiploma: Boolean @rename(attribute: "has_diploma")
  equity: EquitySelections
  languageAbility: LanguageAbility @rename(attribute: "language_ability")
  operationalRequirements: [OperationalRequirement]
    @rename(attribute: "operational_requirements")
  locationPreferences: [WorkRegion] @rename(attribute: "location_preferences")
  wouldAcceptTemporary: Boolean
    @rename(attribute: "would_accept_temporary")
    @deprecated(reason: "replaced with positionDuration")
  positionDuration: [PositionDuration] @rename(attribute: "position_duration")
  expectedClassifications: [Classification]
    @belongsToMany(relation: "classifications")
  skills: [Skill] @belongsToMany
  pools: [Pool] @belongsToMany
}

type PoolCandidateSearchRequest {
  id: ID!
  fullName: String @rename(attribute: "full_name")
  email: Email
  department: Department @belongsTo
  jobTitle: String @rename(attribute: "job_title")
  additionalComments: String @rename(attribute: "additional_comments")
  requestedDate: DateTime @rename(attribute: "created_at")
  status: PoolCandidateSearchStatus
  adminNotes: String @rename(attribute: "admin_notes")
  poolCandidateFilter: PoolCandidateFilter @belongsTo
  applicantFilter: ApplicantFilter @belongsTo
  doneDate: DateTime @rename(attribute: "done_at")
}

enum SkillCategory {
  TECHNICAL
  BEHAVIOURAL
}

type SkillFamily {
  id: ID!
  key: KeyString!
  name: LocalizedString
  description: LocalizedString
  skills: [Skill!] @belongsToMany
  category: SkillCategory!
}

type Skill {
  id: ID!
  key: KeyString!
  name: LocalizedString!
  description: LocalizedString
  keywords: SkillKeywords
  families: [SkillFamily!] @belongsToMany

  # Experiences
  experiences: [Experience!]
  awardExperiences: [AwardExperience!] @hasMany
  communityExperiences: [CommunityExperience!] @hasMany
  educationExperiences: [EducationExperience!] @hasMany
  personalExperiences: [PersonalExperience!] @hasMany
  workExperiences: [WorkExperience!] @hasMany
  # ExperienceSkillRecord is the pivot data and may only be queried when Skill is nested in an Experience (eg. experience->skill->experienceSkillRecord). Querying for it otherwise will just return null.
  experienceSkillRecord: ExperienceSkillRecord
    @rename(attribute: "experience_skill_pivot")
}

type SkillKeywords {
  en: [String!]
  fr: [String!]
}

enum AwardedTo {
  ME
  MY_TEAM
  MY_PROJECT
  MY_ORGANIZATION
}
enum AwardedScope {
  INTERNATIONAL
  NATIONAL
  PROVINCIAL
  LOCAL
  COMMUNITY
  ORGANIZATIONAL
  SUB_ORGANIZATIONAL
}

enum EducationType {
  DIPLOMA
  BACHELORS_DEGREE
  MASTERS_DEGREE
  PHD
  POST_DOCTORAL_FELLOWSHIP
  ONLINE_COURSE
  CERTIFICATION
  OTHER
}
enum EducationStatus {
  SUCCESS_CREDENTIAL
  SUCCESS_NO_CREDENTIAL
  IN_PROGRESS
  AUDITED
  DID_NOT_COMPLETE
}

interface Experience {
  id: ID!
  applicant: Applicant! @belongsTo(relation: "user")
  details: String
  skills: [Skill!] @morphToMany
  # ExperienceSkillRecord is the pivot data and may only be queried when Experience is nested in a Skill (eg. skill->experiences->experienceSkillRecord). Querying for it otherwise will just return null.
  experienceSkillRecord: ExperienceSkillRecord
    @rename(attribute: "experience_skill_pivot")
}

type WorkExperience implements Experience {
  id: ID!
  applicant: Applicant! @belongsTo(relation: "user")
  role: String
  organization: String
  division: String
  startDate: Date @rename(attribute: "start_date")
  endDate: Date @rename(attribute: "end_date")
  details: String
  skills: [Skill!] @morphToMany
  # ExperienceSkillRecord is the pivot data and may only be queried when Experience is nested in a Skill (eg. skill->experiences->experienceSkillRecord). Querying for it otherwise will just return null.
  experienceSkillRecord: ExperienceSkillRecord
    @rename(attribute: "experience_skill_pivot")
}
type PersonalExperience implements Experience {
  id: ID!
  applicant: Applicant! @belongsTo(relation: "user")
  title: String
  description: String
  startDate: Date @rename(attribute: "start_date")
  endDate: Date @rename(attribute: "end_date")
  details: String
  skills: [Skill!] @morphToMany
  # ExperienceSkillRecord is the pivot data and may only be queried when Experience is nested in a Skill (eg. skill->experiences->experienceSkillRecord). Querying for it otherwise will just return null.
  experienceSkillRecord: ExperienceSkillRecord
    @rename(attribute: "experience_skill_pivot")
}
type CommunityExperience implements Experience {
  id: ID!
  applicant: Applicant! @belongsTo(relation: "user")
  title: String
  organization: String
  project: String
  startDate: Date @rename(attribute: "start_date")
  endDate: Date @rename(attribute: "end_date")
  details: String
  skills: [Skill!] @morphToMany
  # ExperienceSkillRecord is the pivot data and must be queried through a nested mutation (eg. experience->skill->experienceSkillRecord) querying for it directly will just return null
  experienceSkillRecord: ExperienceSkillRecord
    @rename(attribute: "experience_skill_pivot")
}
type EducationExperience implements Experience {
  id: ID!
  applicant: Applicant! @belongsTo(relation: "user")
  institution: String
  areaOfStudy: String @rename(attribute: "area_of_study")
  thesisTitle: String @rename(attribute: "thesis_title")
  startDate: Date @rename(attribute: "start_date")
  endDate: Date @rename(attribute: "end_date")
  type: EducationType
  status: EducationStatus
  details: String
  skills: [Skill!] @morphToMany
  # ExperienceSkillRecord is the pivot data and may only be queried when Experience is nested in a Skill (eg. skill->experiences->experienceSkillRecord). Querying for it otherwise will just return null.
  experienceSkillRecord: ExperienceSkillRecord
    @rename(attribute: "experience_skill_pivot")
}
type AwardExperience implements Experience {
  id: ID!
  applicant: Applicant! @belongsTo(relation: "user")
  title: String
  issuedBy: String @rename(attribute: "issued_by")
  awardedDate: Date @rename(attribute: "awarded_date")
  awardedTo: AwardedTo @rename(attribute: "awarded_to")
  awardedScope: AwardedScope @rename(attribute: "awarded_scope")
  details: String
  skills: [Skill!] @morphToMany
  # ExperienceSkillRecord is the pivot data and may only be queried when Experience is nested in a Skill (eg. skill->experiences->experienceSkillRecord). Querying for it otherwise will just return null.
  experienceSkillRecord: ExperienceSkillRecord
    @rename(attribute: "experience_skill_pivot")
}

type ExperienceSkillRecord {
  details: String
}

input ClassificationFilterInput {
  group: String!
  level: Int!
}

input KeyFilterInput {
  key: KeyString!
}

input IdInput {
  id: ID!
}

enum CandidateExpiryFilter {
  ACTIVE
  EXPIRED
  ALL
}

input UserPoolFilterInput {
  poolId: ID!
  expiryStatus: CandidateExpiryFilter = ACTIVE
  statuses: [PoolCandidateStatus!]
}

input PoolCandidateFilterInput {
  equity: EquitySelectionsInput @scope
  expectedClassifications: [ClassificationFilterInput] @scope(name: "classifications")
  email: String @scope
  generalSearch: String @scope
  hasDiploma: Boolean @scope
  languageAbility: LanguageAbility @scope
  locationPreferences: [WorkRegion] @scope
  name: String @scope
  operationalRequirements: [OperationalRequirement] @scope
  pools: [IdInput] @scope(name: "availableInPools") @pluck(key: "id")
  priorityWeight: [Int] @scope
  poolCandidateStatus: [PoolCandidateStatus] @scope(name: "poolCandidateStatuses")
}

input UserFilterInput {
  applicantFilter: ApplicantFilterInput @spread
  poolFilters: [UserPoolFilterInput] @scope(name: "poolFilters")
  jobLookingStatus: [JobLookingStatus] @scope
  isProfileComplete: Boolean @scope
  isGovEmployee: Boolean @scope
  telephone: String @scope
  email: String @scope
  name: String @scope
  generalSearch: String @scope
}

# Changes to this input will require some manual updates to api/app/GraphQL/Queries/CountPoolCandidatesByPool.php since it doesn't use the directives for automatic resolution
input ApplicantFilterInput {
  equity: EquitySelectionsInput @scope
  expectedClassifications: [ClassificationFilterInput]
    @scope(name: "classifications")
  hasDiploma: Boolean @scope
  languageAbility: LanguageAbility @scope
  locationPreferences: [WorkRegion] @scope
  operationalRequirements: [OperationalRequirement] @scope
  positionDuration: [PositionDuration] @scope
  pools: [IdInput] @scope(name: "availableInPools") @pluck(key: "id") # This field is [IdInput] instead of [ID] so that the output of an ApplicantFilter query can be used directly.
  skills: [IdInput] @scope @pluck(key: "id") # This field is [IdInput] instead of [ID] so that the output of an ApplicantFilter query can be used directly.
}

input PoolCandidateSearchInput {
  applicantFilter: ApplicantFilterInput @spread
  email: String @scope
  generalSearch: String @scope
  name: String @scope
  priorityWeight: [Int] @scope(name: "priorityWeight")
  poolCandidateStatus: [PoolCandidateStatus] @scope(name: "poolCandidateStatuses")
}

type CandidateSearchPoolResult {
  pool: Pool!
  candidateCount: Int! @rename(attribute: "candidate_count")
}

type Query {
  me: User @auth
  user(id: UUID! @eq): User @find @guard @can(ability: "view", query: true)
  users: [User]! @all @guard @can(ability: "viewAny")
  usersPaginated(
    where: UserFilterInput
    orderBy: [OrderByClause!] @orderBy
  ): [User]!
    @orderBy(column: "created_at", direction: DESC)
    @paginate(defaultCount: 10, maxCount: 1000)
    @guard
    @can(ability: "viewAny")
  applicant(id: UUID! @eq): Applicant
    @find(model: "User")
    @guard
    @can(ability: "viewApplicant", query: true, model: "User")
  applicants(includeIds: [ID]! @in(key: "id")): [Applicant]!
    @all(model: "User")
    @guard
    @can(ability: "viewAnyApplicants", model: "User")
  # countApplicants returns the number of candidates matching its filters, and requires no special permissions.
  countApplicants(where: ApplicantFilterInput): Int!
    @count(model: "User", scopes: ["availableForOpportunities"])
  pool(id: UUID! @eq): Pool @find @can(ability: "view", query: true)
  poolAdvertisement(id: UUID! @eq): PoolAdvertisement
    @find(model: "Pool")
    @can(ability: "viewAdvertisement", model: "Pool", query: true)
  poolAdvertisements: [PoolAdvertisement]!
    @all(model: "Pool")
    @can(ability: "viewAny", model: "Pool")
  publishedPoolAdvertisements: [PoolAdvertisement!]!
    @all(model: "Pool", scopes: ["wasPublished"])
  poolByKey(key: String! @eq): Pool @find @can(ability: "view", query: true)
  pools: [Pool]! @all @can(ability: "viewAny")
  poolCandidate(id: UUID! @eq): PoolCandidate
    @find
    @guard
    @can(ability: "view", query: true)
  poolCandidates(includeIds: [ID] @in(key: "id")): [PoolCandidate]!
    @all
    @guard
    @can(ability: "viewAny")
  poolCandidatesPaginated(
    where: PoolCandidateSearchInput
    orderBy: _
      @orderBy(
        relations: [
          {
            relation: "user"
            columns: [
              "priority_weight"
              "job_looking_status"
              "first_name"
              "email"
              "preferred_lang"
              "preferred_language_for_interview"
              "preferred_language_for_exam"
              "current_city"
            ]
          }
        ]
      )
  ): [PoolCandidate]!
    @paginate(defaultCount: 10, maxCount: 1000, scopes: ["notDraft", "availableForOpportunities", "expiryFilter"])
    @guard
    @can(ability: "viewAny")
  # countPoolCandidates returns the number of candidates matching its filters, and requires no special permissions.
  countPoolCandidates(where: PoolCandidateFilterInput): Int!
    @deprecated(reason: "Replaced by countApplicants")
    @count(model: "PoolCandidate", scopes: ["expiryFilter", "available"])
  # searchPoolCandidates returns the actual candidates matching a filter, and requires permissions.
  searchPoolCandidates(
    where: PoolCandidateFilterInput
    orderBy: [OrderByClause!] @orderBy
    expiryStatus: CandidateExpiryFilter
  ): [PoolCandidate]!
    @all(scopes: ["expiryFilter", "available"])
    @orderBy(column: "created_at", direction: DESC)
    @guard
    @can(ability: "viewAny")
  # This query lives at api/app/GraphQL/Queries/CountPoolCandidatesByPool.php.
  # Returns the number of candidates by filtering their parent applicant, grouped by pool.
  countPoolCandidatesByPool(
    where: ApplicantFilterInput
  ): [CandidateSearchPoolResult!]!
  classification(id: UUID! @eq): Classification @find
  classifications: [Classification]! @all
  department(id: UUID! @eq): Department @find
  departments: [Department]! @all
  poolCandidateFilter(id: UUID! @eq): PoolCandidateFilter
    @find
    @guard
    @can(ability: "view", query: true)
  poolCandidateFilters: [PoolCandidateFilter]!
    @all
    @guard
    @can(ability: "viewAny")
    @throttle(name: "graphql")
  applicantFilter(id: ID! @eq): ApplicantFilter
    @find
    @guard
    @can(ability: "view", query: true)
  applicantFilters: [ApplicantFilter]! @all @guard @can(ability: "viewAny") @throttle(name: "graphql")
  poolCandidateSearchRequest(id: ID! @eq): PoolCandidateSearchRequest
    @find
    @guard
    @can(ability: "view", query: true)
  poolCandidateSearchRequests(limit: Int @limit): [PoolCandidateSearchRequest]!
    @all
    @guard
    @can(ability: "viewAny")
    @orderBy(column: "created_at", direction: DESC)
  latestPoolCandidateSearchRequests(
    limit: Int @limit
  ): [PoolCandidateSearchRequest]!
    @all
    @orderBy(column: "created_at", direction: DESC)
    @guard
    @can(ability: "viewAny")
    @deprecated(
      reason: "Use poolCandidateSearchRequests instead, with a specified limit"
    )
  skillFamily(id: UUID! @eq): SkillFamily @find
  skillFamilies: [SkillFamily]! @all
  skill(id: UUID! @eq): Skill @find
  skills: [Skill]! @all
  genericJobTitle(id: UUID! @eq): GenericJobTitle @find
  genericJobTitles: [GenericJobTitle]! @all
}
input ClassificationBelongsTo {
  connect: ID
  disconnect: Boolean
}
input PoolsHasMany {
  create: [CreatePoolInput]
}
"""
When creating a User, name is required.
"""
input CreateUserInput {
  sub: String
    @rules(
      apply: ["sometimes", "unique:users,sub"]
      messages: [{ rule: "unique", message: "CreateUserSubInUse" }]
    )
  roles: [Role] = []

  # Personal info
  firstName: String! @rename(attribute: "first_name")
  lastName: String! @rename(attribute: "last_name")
  email: Email
    @rules(
      apply: ["sometimes", "nullable", "unique:users,email"]
      messages: [{ rule: "unique", message: "CreateUserEmailInUse" }]
    )
  telephone: PhoneNumber
  preferredLang: Language @rename(attribute: "preferred_lang")
  preferredLanguageForInterview: Language @rename(attribute: "preferred_language_for_interview")
  preferredLanguageForExam: Language @rename(attribute: "preferred_language_for_exam")
  currentProvince: ProvinceOrTerritory @rename(attribute: "current_province")
  currentCity: String @rename(attribute: "current_city")
  citizenship: CitizenshipStatus
  armedForcesStatus: ArmedForcesStatus @rename(attribute: "armed_forces_status")

  # Language
  lookingForEnglish: Boolean @rename(attribute: "looking_for_english")
  lookingForFrench: Boolean @rename(attribute: "looking_for_french")
  lookingForBilingual: Boolean @rename(attribute: "looking_for_bilingual")
  bilingualEvaluation: BilingualEvaluation
    @rename(attribute: "bilingual_evaluation")
  comprehensionLevel: EvaluatedLanguageAbility
    @rename(attribute: "comprehension_level")
  writtenLevel: EvaluatedLanguageAbility @rename(attribute: "written_level")
  verbalLevel: EvaluatedLanguageAbility @rename(attribute: "verbal_level")
  estimatedLanguageAbility: EstimatedLanguageAbility
    @rename(attribute: "estimated_language_ability")

  # Gov info
  isGovEmployee: Boolean @rename(attribute: "is_gov_employee")
  govEmployeeType: GovEmployeeType @rename(attribute: "gov_employee_type")
  currentClassification: ClassificationBelongsTo
  department: DepartmentBelongsTo
  hasPriorityEntitlement: Boolean @rename(attribute: "has_priority_entitlement")
  priorityNumber: String @rename(attribute: "priority_number")

  # Employment equity
  isWoman: Boolean @rename(attribute: "is_woman")
  hasDisability: Boolean @rename(attribute: "has_disability")
  isVisibleMinority: Boolean @rename(attribute: "is_visible_minority")
  indigenousCommunities: [IndigenousCommunity]
    @rename(attribute: "indigenous_communities")
  indigenousDeclarationSignature: String
    @rename(attribute: "indigenous_declaration_signature")

  # Applicant info
  jobLookingStatus: JobLookingStatus @rename(attribute: "job_looking_status")
  hasDiploma: Boolean @rename(attribute: "has_diploma")
  locationPreferences: [WorkRegion] @rename(attribute: "location_preferences")
  locationExemptions: String @rename(attribute: "location_exemptions")
  acceptedOperationalRequirements: [OperationalRequirement]
    @rename(attribute: "accepted_operational_requirements")
  expectedSalary: [SalaryRange] @rename(attribute: "expected_salary")
  expectedClassifications: ClassificationBelongsToMany
  expectedGenericJobTitles: GenericJobTitleBelongsToMany
  positionDuration: [PositionDuration] @rename(attribute: "position_duration")

  # Experiences
  workExperiences: WorkExperienceHasMany
  personalExperiences: PersonalExperienceHasMany
  communityExperiences: CommunityExperienceHasMany
  educationExperiences: EducationExperienceHasMany
  awardExperiences: AwardExperienceHasMany
}
"""
When updating a User, all fields are optional
"""
input UpdateUserAsAdminInput
  @validator(class: "App\\GraphQL\\Validators\\UpdateUserInputValidator") {
  id: ID
  sub: String
  roles: [Role]

  # Personal info
  email: Email
  firstName: String @rename(attribute: "first_name")
  lastName: String @rename(attribute: "last_name")
  telephone: PhoneNumber
  preferredLang: Language @rename(attribute: "preferred_lang")
  preferredLanguageForInterview: Language @rename(attribute: "preferred_language_for_interview")
  preferredLanguageForExam: Language @rename(attribute: "preferred_language_for_exam")
  currentProvince: ProvinceOrTerritory @rename(attribute: "current_province")
  currentCity: String @rename(attribute: "current_city")
  citizenship: CitizenshipStatus
  armedForcesStatus: ArmedForcesStatus @rename(attribute: "armed_forces_status")

  # Language
  lookingForEnglish: Boolean @rename(attribute: "looking_for_english")
  lookingForFrench: Boolean @rename(attribute: "looking_for_french")
  lookingForBilingual: Boolean @rename(attribute: "looking_for_bilingual")
  bilingualEvaluation: BilingualEvaluation
    @rename(attribute: "bilingual_evaluation")
  comprehensionLevel: EvaluatedLanguageAbility
    @rename(attribute: "comprehension_level")
  writtenLevel: EvaluatedLanguageAbility @rename(attribute: "written_level")
  verbalLevel: EvaluatedLanguageAbility @rename(attribute: "verbal_level")
  estimatedLanguageAbility: EstimatedLanguageAbility
    @rename(attribute: "estimated_language_ability")

  # Gov info
  isGovEmployee: Boolean @rename(attribute: "is_gov_employee")
  govEmployeeType: GovEmployeeType @rename(attribute: "gov_employee_type")
  currentClassification: ClassificationBelongsTo
  department: DepartmentBelongsTo
  hasPriorityEntitlement: Boolean @rename(attribute: "has_priority_entitlement")
  priorityNumber: String @rename(attribute: "priority_number")

  # Employment equity
  isWoman: Boolean @rename(attribute: "is_woman")
  hasDisability: Boolean @rename(attribute: "has_disability")
  isVisibleMinority: Boolean @rename(attribute: "is_visible_minority")
  indigenousCommunities: [IndigenousCommunity]
    @rename(attribute: "indigenous_communities")
  indigenousDeclarationSignature: String
    @rename(attribute: "indigenous_declaration_signature")

  # Applicant info
  jobLookingStatus: JobLookingStatus @rename(attribute: "job_looking_status")

  hasDiploma: Boolean @rename(attribute: "has_diploma")
  locationPreferences: [WorkRegion] @rename(attribute: "location_preferences")
  locationExemptions: String @rename(attribute: "location_exemptions")
  acceptedOperationalRequirements: [OperationalRequirement]
    @rename(attribute: "accepted_operational_requirements")
  expectedSalary: [SalaryRange] @rename(attribute: "expected_salary")
  expectedClassifications: ClassificationBelongsToMany
  expectedGenericJobTitles: GenericJobTitleBelongsToMany
  positionDuration: [PositionDuration] @rename(attribute: "position_duration")

  # Experiences
  workExperiences: WorkExperienceHasMany
  personalExperiences: PersonalExperienceHasMany
  communityExperiences: CommunityExperienceHasMany
  educationExperiences: EducationExperienceHasMany
  awardExperiences: AwardExperienceHasMany
}

input UpdateUserAsUserInput
  @validator(class: "App\\GraphQL\\Validators\\UpdateUserInputValidator") {
  id: ID
  # Personal info
  email: Email
  firstName: String @rename(attribute: "first_name")
  lastName: String @rename(attribute: "last_name")
  telephone: PhoneNumber
  preferredLang: Language @rename(attribute: "preferred_lang")
  preferredLanguageForInterview: Language @rename(attribute: "preferred_language_for_interview")
  preferredLanguageForExam: Language @rename(attribute: "preferred_language_for_exam")
  currentProvince: ProvinceOrTerritory @rename(attribute: "current_province")
  currentCity: String @rename(attribute: "current_city")
  citizenship: CitizenshipStatus
  armedForcesStatus: ArmedForcesStatus @rename(attribute: "armed_forces_status")

  # Language
  lookingForEnglish: Boolean @rename(attribute: "looking_for_english")
  lookingForFrench: Boolean @rename(attribute: "looking_for_french")
  lookingForBilingual: Boolean @rename(attribute: "looking_for_bilingual")
  bilingualEvaluation: BilingualEvaluation
    @rename(attribute: "bilingual_evaluation")
  comprehensionLevel: EvaluatedLanguageAbility
    @rename(attribute: "comprehension_level")
  writtenLevel: EvaluatedLanguageAbility @rename(attribute: "written_level")
  verbalLevel: EvaluatedLanguageAbility @rename(attribute: "verbal_level")
  estimatedLanguageAbility: EstimatedLanguageAbility
    @rename(attribute: "estimated_language_ability")

  # Gov info
  isGovEmployee: Boolean @rename(attribute: "is_gov_employee")
  govEmployeeType: GovEmployeeType @rename(attribute: "gov_employee_type")
  currentClassification: ClassificationBelongsTo
  department: DepartmentBelongsTo
  hasPriorityEntitlement: Boolean @rename(attribute: "has_priority_entitlement")
  priorityNumber: String @rename(attribute: "priority_number")

  # Employment equity
  isWoman: Boolean @rename(attribute: "is_woman")
  hasDisability: Boolean @rename(attribute: "has_disability")
  isVisibleMinority: Boolean @rename(attribute: "is_visible_minority")
  indigenousCommunities: [IndigenousCommunity]
    @rename(attribute: "indigenous_communities")
  indigenousDeclarationSignature: String
    @rename(attribute: "indigenous_declaration_signature")

  # Applicant info
  jobLookingStatus: JobLookingStatus @rename(attribute: "job_looking_status")

  hasDiploma: Boolean @rename(attribute: "has_diploma")
  locationPreferences: [WorkRegion] @rename(attribute: "location_preferences")
  locationExemptions: String @rename(attribute: "location_exemptions")
  acceptedOperationalRequirements: [OperationalRequirement]
    @rename(attribute: "accepted_operational_requirements")
  expectedSalary: [SalaryRange] @rename(attribute: "expected_salary")
  expectedClassifications: ClassificationBelongsToMany
  expectedGenericJobTitles: GenericJobTitleBelongsToMany
  positionDuration: [PositionDuration] @rename(attribute: "position_duration")

  # Experiences
  workExperiences: WorkExperienceHasMany
  personalExperiences: PersonalExperienceHasMany
  communityExperiences: CommunityExperienceHasMany
  educationExperiences: EducationExperienceHasMany
  awardExperiences: AwardExperienceHasMany
}

input LocalizedStringInput {
  en: String
  fr: String
}

input UserBelongsTo {
  connect: ID
}

input PoolBelongsTo {
  connect: ID!
}

input CreateClassificationInput {
  name: LocalizedStringInput
  group: String!
  level: Int!
  minSalary: Int @rename(attribute: "min_salary")
  maxSalary: Int @rename(attribute: "max_salary")
}

input ClassificationBelongsToMany {
  sync: [ID!]
}

input ConnectOrCreateBelongsTo {
  connect: ID
  create: CreateUserInput
}

input CreatePoolCandidateAsAdminInput {
  pool: PoolBelongsTo!
  user: ConnectOrCreateBelongsTo! # TODO: This should be switched to UserBelongsTo as soon as possible. Permission to create a PoolCandidate shouldn't imply permission to create a User. See https://github.com/GCTC-NTGC/gc-digital-talent/issues/2356
  cmoIdentifier: ID @rename(attribute: "cmo_identifier")
  expiryDate: Date @rename(attribute: "expiry_date")
  status: PoolCandidateStatus = NEW_APPLICATION
    @rename(attribute: "pool_candidate_status")
  notes: String
}

input CreatePoolInput {
  owner: UserBelongsTo! @rename(attribute: "user")
  name: LocalizedStringInput!
  key: KeyString
  description: LocalizedStringInput
  classifications: ClassificationBelongsToMany
  operationalRequirements: [OperationalRequirement]
    @rename(attribute: "operational_requirements")
  keyTasks: LocalizedStringInput @rename(attribute: "key_tasks")
  status: PoolStatus = NOT_TAKING_APPLICATIONS @rename(attribute: "pool_status")
  processNumber: String @rename(attribute: "process_number")
  publishingGroup: PublishingGroup @rename(attribute: "publishing_group")
}

input UpdateClassificationInput {
  name: LocalizedStringInput
  group: String
  minSalary: Int @rename(attribute: "min_salary")
  maxSalary: Int @rename(attribute: "max_salary")
}

input UpdatePoolCandidateAsAdminInput {
  cmoIdentifier: ID @rename(attribute: "cmo_identifier")
  expiryDate: Date @rename(attribute: "expiry_date")
  status: PoolCandidateStatus @rename(attribute: "pool_candidate_status")
  notes: String
}

input UpdatePoolInput {
  owner: UserBelongsTo @rename(attribute: "user")
  name: LocalizedStringInput
  description: LocalizedStringInput
  classifications: ClassificationBelongsToMany
  operationalRequirements: [OperationalRequirement]
    @rename(attribute: "operational_requirements")
  keyTasks: LocalizedStringInput @rename(attribute: "key_tasks")
  status: PoolStatus @rename(attribute: "pool_status")
  stream: PoolStream
  processNumber: String @rename(attribute: "process_number")
  publishingGroup: PublishingGroup @rename(attribute: "publishing_group")
}

input CreateDepartmentInput {
  departmentNumber: Int! @rename(attribute: "department_number")
  name: LocalizedStringInput
}

input UpdateDepartmentInput {
  departmentNumber: Int @rename(attribute: "department_number")
  name: LocalizedStringInput
}

input PoolBelongsToMany {
  sync: [ID!]
}

input DepartmentBelongsTo {
  connect: ID!
}

input CreatePoolCandidateFilterInput {
  classifications: ClassificationBelongsToMany
  hasDiploma: Boolean @rename(attribute: "has_diploma")
  equity: EquitySelectionsInput
  languageAbility: LanguageAbility @rename(attribute: "language_ability")
  operationalRequirements: [OperationalRequirement]
    @rename(attribute: "operational_requirements")
  workRegions: [WorkRegion] @rename(attribute: "work_regions")
  pools: PoolBelongsToMany
}

input PoolCandidateFilterBelongsTo {
  create: CreatePoolCandidateFilterInput!
}

input CreateApplicantFilterInput {
  hasDiploma: Boolean @rename(attribute: "has_diploma")
  equity: EquitySelectionsInput @spread
  languageAbility: LanguageAbility @rename(attribute: "language_ability")
  operationalRequirements: [OperationalRequirement]
    @rename(attribute: "operational_requirements")
  locationPreferences: [WorkRegion] @rename(attribute: "location_preferences")
  positionDuration: [PositionDuration] @rename(attribute: "position_duration")
  expectedClassifications: ClassificationBelongsToMany
    @rename(attribute: "classifications")
  skills: SkillBelongsToMany
  pools: PoolBelongsToMany
  citizenship: CitizenshipStatus
  armedForcesStatus: ArmedForcesStatus @rename(attribute: "armed_forces_status")
}

input ApplicantFilterBelongsTo {
  create: CreateApplicantFilterInput!
}

input CreatePoolCandidateSearchRequestInput {
  fullName: String! @rename(attribute: "full_name")
  email: Email!
  department: DepartmentBelongsTo!
  jobTitle: String! @rename(attribute: "job_title")
  additionalComments: String @rename(attribute: "additional_comments")
  poolCandidateFilter: PoolCandidateFilterBelongsTo
    @rules(apply: ["required_without:applicantFilter"]) # TODO: remove this field when we've completed the transition from using poolCandidateCount to applicantCount
  applicantFilter: ApplicantFilterBelongsTo
    @rules(apply: ["required_without:poolCandidateFilter"]) # TODO: make this required when we've completed the transition from using poolCandidateCount to applicantCount
  # requestedDate will be set to current date in Eloquent model.
  # status will be set to PENDING in Eloquent model.
}

input UpdatePoolCandidateSearchRequestInput {
  adminNotes: String @rename(attribute: "admin_notes")
  status: PoolCandidateSearchStatus
}

input SkillBelongsToMany {
  sync: [ID!]
}
input CreateSkillFamilyInput {
  key: KeyString!
    @rules(
      apply: ["unique:skill_families,key"]
      messages: [{ rule: "unique", message: "SkillFamilyKeyStringInUse" }]
    )
  name: LocalizedStringInput!
  description: LocalizedStringInput
  skills: SkillBelongsToMany
  category: SkillCategory!
}

input UpdateSkillFamilyInput {
  name: LocalizedStringInput
  description: LocalizedStringInput
  skills: SkillBelongsToMany
  category: SkillCategory
}

input SkillFamilyBelongsToMany {
  sync: [ID!]
}

input SkillKeywordsInput {
  en: [String!]
  fr: [String!]
}

input CreateSkillInput {
  key: KeyString!
  name: LocalizedStringInput!
  description: LocalizedStringInput
  families: SkillFamilyBelongsToMany
  keywords: SkillKeywordsInput
}

input UpdateSkillInput {
  name: LocalizedStringInput!
  description: LocalizedStringInput
  families: SkillFamilyBelongsToMany
  keywords: SkillKeywordsInput
}

input WorkExperienceInput {
  role: String
  organization: String
  division: String
  startDate: Date @rename(attribute: "start_date")
  endDate: Date @rename(attribute: "end_date")
  details: String
  skills: UpdateExperienceSkills
}
input PersonalExperienceInput {
  title: String
  description: String
  startDate: Date @rename(attribute: "start_date")
  endDate: Date @rename(attribute: "end_date")
  details: String
  skills: UpdateExperienceSkills
}
input CommunityExperienceInput {
  title: String
  organization: String
  project: String
  startDate: Date @rename(attribute: "start_date")
  endDate: Date @rename(attribute: "end_date")
  details: String
  skills: UpdateExperienceSkills
}
input EducationExperienceInput {
  institution: String
  areaOfStudy: String @rename(attribute: "area_of_study")
  thesisTitle: String @rename(attribute: "thesis_title")
  startDate: Date @rename(attribute: "start_date")
  endDate: Date @rename(attribute: "end_date")
  type: EducationType
  status: EducationStatus
  details: String
  skills: UpdateExperienceSkills
}
input AwardExperienceInput {
  title: String
  issuedBy: String @rename(attribute: "issued_by")
  awardedDate: Date @rename(attribute: "awarded_date")
  awardedTo: AwardedTo @rename(attribute: "awarded_to")
  awardedScope: AwardedScope @rename(attribute: "awarded_scope")
  details: String
  skills: UpdateExperienceSkills
}

input UpdateExperienceSkills {
  connect: [ConnectExperienceSkills!]
  sync: [ConnectExperienceSkills!]
}

input ConnectExperienceSkills {
  id: ID!
  details: String
}

input WorkExperienceHasMany {
  create: [WorkExperienceInput!]
}
input PersonalExperienceHasMany {
  create: [PersonalExperienceInput!]
}
input CommunityExperienceHasMany {
  create: [CommunityExperienceInput!]
}
input EducationExperienceHasMany {
  create: [EducationExperienceInput!]
}
input AwardExperienceHasMany {
  create: [AwardExperienceInput!]
}
input GenericJobTitleBelongsToMany {
  sync: [ID!]
}

input CreatePoolAdvertisementInput {
  classifications: ClassificationBelongsToMany
}

input UpdatePoolAdvertisementInput {
  # Pool name and classification
  name: LocalizedStringInput
  classifications: ClassificationBelongsToMany
  stream: PoolStream
  processNumber: String @rename(attribute: "process_number")
  # Closing date
  closingDate: DateTime
    @rename(attribute: "closing_date")
    @rules(
      apply: ["after:today"]
      messages: [{ rule: "after", message: "UpdatePoolClosingDate" }]
    )
  # Your impact
  yourImpact: LocalizedStringInput @rename(attribute: "your_impact")
  # Work Tasks
  keyTasks: LocalizedStringInput @rename(attribute: "key_tasks")
  # Essential skills and Asset skills
  essentialSkills: SkillBelongsToMany
  nonessentialSkills: SkillBelongsToMany
  # Other requirements
  advertisementLanguage: PoolAdvertisementLanguage
    @rename(attribute: "advertisement_language")
  securityClearance: SecurityStatus @rename(attribute: "security_clearance")
  advertisementLocation: LocalizedStringInput
    @rename(attribute: "advertisement_location")
  isRemote: Boolean @rename(attribute: "is_remote")
  publishingGroup: PublishingGroup @rename(attribute: "publishing_group")
}

type Mutation {
  createUser(user: CreateUserInput! @spread): User
    @create
    @guard
    @can(ability: "create")
    @throttle(maxAttempts: 100)
  updateUserAsUser(id: ID!, user: UpdateUserAsUserInput! @spread): User
    @update
    @guard
    @can(ability: "update", find: "id")
  updateUserAsAdmin(id: ID!, user: UpdateUserAsAdminInput! @spread): User
    @update
    @guard
    @can(ability: "update", find: "id")
  deleteUser(id: ID!): User
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")
  createPool(pool: CreatePoolInput! @spread): Pool
    @create
    @guard
    @can(ability: "create")
  updatePool(id: ID!, pool: UpdatePoolInput! @spread): Pool
    @update
    @guard
    @can(ability: "update", find: "id")
  deletePool(id: ID!): Pool
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")
  createPoolCandidateAsAdmin(
    poolCandidate: CreatePoolCandidateAsAdminInput! @spread
  ): PoolCandidate @create @guard @can(ability: "create")
  updatePoolCandidateAsAdmin(
    id: ID!
    poolCandidate: UpdatePoolCandidateAsAdminInput! @spread
  ): PoolCandidate @update @guard @can(ability: "update", find: "id")
  deletePoolCandidate(id: ID!): PoolCandidate
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")
  createClassification(
    classification: CreateClassificationInput! @spread
  ): Classification @create @guard @can(ability: "create")
  updateClassification(
    id: ID!
    classification: UpdateClassificationInput! @spread
  ): Classification @update @guard @can(ability: "update", find: "id")
  deleteClassification(id: ID!): Classification
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")
  createDepartment(department: CreateDepartmentInput! @spread): Department
    @create
    @guard
    @can(ability: "create")
  updateDepartment(
    id: ID!
    department: UpdateDepartmentInput! @spread
  ): Department @update @can(ability: "update", find: "id")
  deleteDepartment(id: ID!): Department
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")
  createPoolCandidateSearchRequest(
    poolCandidateSearchRequest: CreatePoolCandidateSearchRequestInput! @spread
  ): PoolCandidateSearchRequest @create @can(ability: "create")
  updatePoolCandidateSearchRequest(
    id: ID!
    poolCandidateSearchRequest: UpdatePoolCandidateSearchRequestInput! @spread
  ): PoolCandidateSearchRequest
    @update
    @guard
    @can(ability: "update", find: "id")
  createSkillFamily(skillFamily: CreateSkillFamilyInput! @spread): SkillFamily
    @create
    @guard
    @can(ability: "create")
  updateSkillFamily(
    id: ID!
    skillFamily: UpdateSkillFamilyInput! @spread
  ): SkillFamily @update @guard @can(ability: "update", find: "id")
  createSkill(skill: CreateSkillInput! @spread): Skill
    @create
    @guard
    @can(ability: "create")
  updateSkill(id: ID!, skill: UpdateSkillInput! @spread): Skill
    @update
    @guard
    @can(ability: "update", find: "id")
  createWorkExperience(
    userId: ID! @rename(attribute: "user_id")
    workExperience: WorkExperienceInput! @spread
  ): WorkExperience @create @can(ability: "create", injectArgs: true)
  createPersonalExperience(
    userId: ID! @rename(attribute: "user_id")
    personalExperience: PersonalExperienceInput! @spread
  ): PersonalExperience @create @can(ability: "create", injectArgs: true)
  createCommunityExperience(
    userId: ID! @rename(attribute: "user_id")
    communityExperience: CommunityExperienceInput! @spread
  ): CommunityExperience @create @can(ability: "create", injectArgs: true)
  createEducationExperience(
    userId: ID! @rename(attribute: "user_id")
    educationExperience: EducationExperienceInput! @spread
  ): EducationExperience @create @can(ability: "create", injectArgs: true)
  createAwardExperience(
    userId: ID! @rename(attribute: "user_id")
    awardExperience: AwardExperienceInput! @spread
  ): AwardExperience @create @can(ability: "create", injectArgs: true)
  updateWorkExperience(
    id: ID!
    workExperience: WorkExperienceInput! @spread
  ): WorkExperience @update @guard @can(ability: "update", find: "id")
  updatePersonalExperience(
    id: ID!
    personalExperience: PersonalExperienceInput! @spread
  ): PersonalExperience @update @guard @can(ability: "update", find: "id")
  updateCommunityExperience(
    id: ID!
    communityExperience: CommunityExperienceInput! @spread
  ): CommunityExperience @update @guard @can(ability: "update", find: "id")
  updateEducationExperience(
    id: ID!
    educationExperience: EducationExperienceInput! @spread
  ): EducationExperience @update @guard @can(ability: "update", find: "id")
  updateAwardExperience(
    id: ID!
    awardExperience: AwardExperienceInput! @spread
  ): AwardExperience @update @guard @can(ability: "update", find: "id")
  deleteWorkExperience(id: ID!): WorkExperience
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")
  deletePersonalExperience(id: ID!): PersonalExperience
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")
  deleteCommunityExperience(id: ID!): CommunityExperience
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")
  deleteEducationExperience(id: ID!): EducationExperience
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")
  deleteAwardExperience(id: ID!): AwardExperience
    @delete(globalId: false)
    @guard
    @can(ability: "delete", find: "id")

  # PoolAdvertisement mutations
  createPoolAdvertisement(
    userId: ID! @rename(attribute: "user_id")
    poolAdvertisement: CreatePoolAdvertisementInput! @spread
  ): PoolAdvertisement
    @create(model: "Pool")
    @guard
    @can(ability: "create", model: "Pool")
  updatePoolAdvertisement(
    id: ID!
    poolAdvertisement: UpdatePoolAdvertisementInput! @spread
  ): PoolAdvertisement
    @update(model: "Pool")
    @guard
    @can(ability: "update", find: "id", model: "Pool")
  publishPoolAdvertisement(id: ID!): PoolAdvertisement
    @guard
    @can(ability: "publish", find: "id", model: "Pool")
  changePoolClosingDate(
    id: ID!
    newClosingDate: DateTime!
      @rename(attribute: "new_closing_date")
      @rules(
        apply: ["after:today"]
        messages: [{ rule: "after", message: "UpdatePoolClosingDate" }]
      )
  ): PoolAdvertisement
    @guard
    @can(ability: "changePoolClosingDate", find: "id", model: "Pool")
  closePoolAdvertisement(id: ID!): PoolAdvertisement
    @guard
    @can(ability: "closePoolAdvertisement", find: "id", model: "Pool")
  deletePoolAdvertisement(id: ID!): PoolAdvertisement
    @delete(model: "Pool", globalId: false)
    @guard
    @can(ability: "delete", find: "id", model: "Pool")

  # Application mutations
  archiveApplication(id: ID!): PoolCandidate
    @guard
    @can(ability: "archiveApplication", find: "id")
  createApplication(userId: ID!, poolId: ID!): PoolCandidate
  deleteApplication(id: ID!): Boolean
    @guard
    @can(ability: "deleteApplication", find: "id", model: "PoolCandidate")
  submitApplication(id: ID!, signature: String!): PoolCandidate
}
