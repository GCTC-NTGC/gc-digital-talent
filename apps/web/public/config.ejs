/**
 * This file is dynamically updated on build and deployment to send some variables to the client.
 * First choice variables are substituted from the environment on deployment.  Second choice is variables substituted on build.
 */

 // only take the string if the variable has been replaced with something
 const filterUnusable = (value) => !value.startsWith('$') && value.length > 0 ? value : undefined;


const data = new Map([
    // auth settings
    ["OAUTH_POST_LOGOUT_REDIRECT", filterUnusable("$OAUTH_POST_LOGOUT_REDIRECT") ?? "<%= htmlWebpackPlugin.options.environment.OAUTH_POST_LOGOUT_REDIRECT %>"],
    ["OAUTH_LOGOUT_URI", filterUnusable("$OAUTH_LOGOUT_URI") ?? "<%= htmlWebpackPlugin.options.environment.OAUTH_LOGOUT_URI %>"],

    // Feature flags
    ["FEATURE_ONGOING_RECRUITMENTS", filterUnusable("$FEATURE_ONGOING_RECRUITMENTS") ?? "<%= htmlWebpackPlugin.options.environment.FEATURE_ONGOING_RECRUITMENTS %>"],
    ["FEATURE_APPLICANT_DASHBOARD", filterUnusable("$FEATURE_APPLICANT_DASHBOARD") ?? "<%= htmlWebpackPlugin.options.environment.FEATURE_APPLICANT_DASHBOARD %>"],
    ["FEATURE_APPLICATION_REVAMP", filterUnusable("$FEATURE_APPLICATION_REVAMP") ?? "<%= htmlWebpackPlugin.options.environment.FEATURE_APPLICATION_REVAMP %>"],

    // Azure application insights not used in dev
    ["APPLICATIONINSIGHTS_CONNECTION_STRING", filterUnusable("$APPLICATIONINSIGHTS_CONNECTION_STRING")],

    // Logging levels
    ["LOG_CONSOLE_LEVEL", filterUnusable("$LOG_CONSOLE_LEVEL") ?? "<%= htmlWebpackPlugin.options.environment.LOG_CONSOLE_LEVEL %>"],
    ["LOG_APPLICATIONINSIGHTS_LEVEL", filterUnusable("$LOG_APPLICATIONINSIGHTS_LEVEL") ?? "<%= htmlWebpackPlugin.options.environment.LOG_APPLICATIONINSIGHTS_LEVEL %>"],
]);

window.__SERVER_CONFIG__ = data;
